# GATT-Client-Win11
A GATT client implementation on Windows 11.

## Prerequisite
### .NET8.0
* link: https://dotnet.microsoft.com/en-us/download
* check versions: `dotnet --list-sdks`

## Initialize Project
1. Generate Project (This part is already done in this repo, there is no need to do it again.)
    `dotnet new console --framework net8.0 --use-program-main`
2. Project Settings (This part is already done in this repo, there is no need to do it again.)
    * modify `<TargetFramework>` in the `.csproj` file to `net8.0-windows10.0.22000.0`
    * `net8.0-windows10.0.22000.0` is the framework of Win11
3. Add Package
    * Windows Device API
        `dotnet add package Microsoft.Windows.CsWinRT --version 2.0.7`
    * Audio Core API
        `dotnet add package AudioSwitcher.AudioApi.CoreAudio --version 3.0.3`
        * Please note that the current version is not specifically designed for .NET 8.0, but it works in this scenario. If you need to use additional core audio functions that are not compatible with .NET 8.0, you may need to find alternative packages that support your requirements.
    * Performance counter
        `dotnet add package System.Diagnostics.PerformanceCounter --version 8.0.0`

## Run Project
`dotnet run` for volume mode
`dotnet run CPU` for CPU usage mode

## Project Structure
Windows-GATT/
├── Program.cs: main function
├── utility/
│   ├── AdvertisementScanner.cs: scan BLE advertisements
│   ├── GetBLEData.cs: subscribe to GATT characteristic
|   ├── VolumeController.cs: controll PC speaker volume
│   └── CPUUsage.cs: get average CPU usage
├── GATT-Client-Win11.csproj: project settings
├── GATT-Client-Win11.sln: something generated by .NET
├── bin/*: something generated by .NET
├── obj/*: something generated by .NET
└── README.md: this file

## Reference
https://learn.microsoft.com/en-us/windows/uwp/devices-sensors/bluetooth-low-energy-overview